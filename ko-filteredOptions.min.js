ko.bindingHandlers.filteredOptions={update:function(element,valueAccessor,allBindingsAccessor){if(ko.utils.tagNameLower(element)!=="select"){throw new Error("options binding applies only to SELECT elements")}var selectWasPreviouslyEmpty=element.length===0;var previousSelectedValues=ko.utils.arrayMap(ko.utils.arrayFilter(element.childNodes,function(node){return node.tagName&&(ko.utils.tagNameLower(node)==="option")&&node.selected}),function(node){return ko.selectExtensions.readValue(node)||node.innerText||node.textContent});var previousScrollTop=element.scrollTop;var value=ko.utils.unwrapObservable(valueAccessor());var selectedValue=element.value;while(element.length>0){ko.cleanNode(element.options[0]);element.remove(0)}if(value){var allBindings=allBindingsAccessor(),includeDestroyed=allBindings.optionsIncludeDestroyed;if(typeof value.length!="number"){value=[value]}if(allBindings.optionsCaption){var option=document.createElement("option");ko.utils.setHtml(option,allBindings.optionsCaption);ko.selectExtensions.writeValue(option,undefined);element.appendChild(option)}for(var i=0,j=value.length;i<j;i++){var arrayEntry=value[i];if(arrayEntry&&arrayEntry._destroy&&!includeDestroyed){continue}var option=document.createElement("option");var applyToObject=function(object,predicate,defaultValue){var predicateType=typeof predicate;if(predicateType=="function"){return predicate(object)}else{if(predicateType=="string"){return object[predicate]}else{return defaultValue}}};var optionValue=applyToObject(arrayEntry,allBindings.optionsValue,arrayEntry);ko.selectExtensions.writeValue(option,ko.utils.unwrapObservable(optionValue));var optionText=applyToObject(arrayEntry,allBindings.optionsText,optionValue);ko.utils.setTextContent(option,optionText);var filter=allBindings.optionsFiltering;if(filter){var propValue;if(filter.propertyName){propValue=arrayEntry[filter.propertyName]}else{propValue=arrayEntry}var exception=ko.utils.unwrapObservable(filter.exceptionValue)!==undefined&&ko.utils.unwrapObservable(optionValue)==ko.utils.unwrapObservable(filter.exceptionValue);if(ko.utils.unwrapObservable(propValue)==ko.utils.unwrapObservable(filter.propertyValue)&&!exception){continue}}element.appendChild(option)}var newOptions=element.getElementsByTagName("option");var countSelectionsRetained=0;for(var i=0,j=newOptions.length;i<j;i++){if(ko.utils.arrayIndexOf(previousSelectedValues,ko.selectExtensions.readValue(newOptions[i]))>=0){ko.utils.setOptionNodeSelectionState(newOptions[i],true);countSelectionsRetained++}}element.scrollTop=previousScrollTop;if(selectWasPreviouslyEmpty&&("value" in allBindings)){ko.utils.ensureDropdownSelectionIsConsistentWithModelValue(element,ko.utils.peekObservable(allBindings.value),true)}ko.utils.ensureSelectElementIsRenderedCorrectly(element)}}};ko.extenders.track=function(target,doTrack){if(doTrack){target.isTracked=true;target.originalValue=target();target.subscribe(function(newValue){if(newValue==target.originalValue){target.modified=false}else{target.modified=true}})}else{target.isTracked=false}return target};ko.dependencyDetection=(function(){var _frames=[];return{begin:function(callback){_frames.push({callback:callback,distinctDependencies:[]})},end:function(){_frames.pop()},registerDependency:function(subscribable){if(!ko.isSubscribable(subscribable)){throw new Error("Only subscribable things can act as dependencies")}if(_frames.length>0){var topFrame=_frames[_frames.length-1];if(!topFrame||ko.utils.arrayIndexOf(topFrame.distinctDependencies,subscribable)>=0){return}topFrame.distinctDependencies.push(subscribable);topFrame.callback(subscribable)}},ignore:function(callback,callbackTarget,callbackArgs){try{_frames.push(null);return callback.apply(callbackTarget,callbackArgs||[])}finally{_frames.pop()}}}})();$.extend(ko.utils,{getIEVersion:function(){var version=3,div=document.createElement("div"),iElems=div.getElementsByTagName("i");while(div.innerHTML="<!--[if gt IE "+(++version)+"]><i></i><![endif]-->",iElems[0]){}return version>4?version:undefined},ensureDropdownSelectionIsConsistentWithModelValue:function(element,modelValue,preferModelValue){if(preferModelValue){if(modelValue!==ko.selectExtensions.readValue(element)){ko.selectExtensions.writeValue(element,modelValue)}}if(modelValue!==ko.selectExtensions.readValue(element)){ko.dependencyDetection.ignore(ko.utils.triggerEvent,null,[element,"change"])}},ensureSelectElementIsRenderedCorrectly:function(selectElement){if(ko.utils.getIEVersion()>=9){var originalWidth=selectElement.style.width;selectElement.style.width=0;selectElement.style.width=originalWidth}},tagNameLower:function(element){return element&&element.tagName&&element.tagName.toLowerCase()},forceRefresh:function(node){if(ko.utils.getIEVersion()>=9){var elem=node.nodeType==1?node:node.parentNode;if(elem.style){elem.style.zoom=elem.style.zoom}}},setTextContent:function(element,textContent){var value=ko.utils.unwrapObservable(textContent);if((value===null)||(value===undefined)){value=""}if(element.nodeType===3){element.data=value}else{var innerTextNode=ko.virtualElements.firstChild(element);if(!innerTextNode||innerTextNode.nodeType!=3||ko.virtualElements.nextSibling(innerTextNode)){ko.virtualElements.setDomNodeChildren(element,[document.createTextNode(value)])}else{innerTextNode.data=value}ko.utils.forceRefresh(element)}},setOptionNodeSelectionState:function(optionNode,isSelected){if(ko.utils.getIEVersion()<7){optionNode.setAttribute("selected",isSelected)}else{optionNode.selected=isSelected}}});